<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>外部信号+股债动态平衡5股组合 - 策略详情</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 30px;
            line-height: 1.8;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .meta { color: #888; margin-bottom: 30px; font-size: 0.9rem; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h2 {
            font-size: 1.2rem;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section p, .section pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #ccc;
        }
        pre {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .back-btn:hover { opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(0,0,0,0.2); color: #00d4ff; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">← 返回列表</a>
        <h1>外部信号+股债动态平衡5股组合</h1>
        <p class="meta">
            ID: 672ee8e6 | 
            类型: 多因子选股+趋势跟踪 | 
            来源: b2324_83.回测“一创模拟盘2号”，最终优化，年化39%.txt |
            分析日期: 2026-01-11 18:30:11
        </p>

        <div class="section">
            <h2>策略逻辑概要</h2>
            <p>1) 选股完全依赖盘前产出的外部 CSV 文件（未知算法）给出当日候选股票；2) 盘中 14:55 读取文件后，对比当前持仓与买入列表做增删；3) 同时用中证 1000-指数(399008) 的分钟级动量(MA10) 判断牛熊并控制股票/债券(511010) 仓位比例：牛市股票 100%，熊市股票 30%+债券 70%；4) 单只股票持有过程中若从历史最高价回撤 &gt;3% 且已不在买入列表, 或已持有≥10天且不在买入列表则清仓；5) 为避免来回交易，同一股票卖出后 5 天内禁止再次买入。</p>
        </div>

        <div class="section">
            <h2>股票池</h2>
            <p>未在代码中限制；默认全 A 股（可能包含 ST/停牌/次新）；仅通过聚宽撮合规则自动排除停牌、涨跌停。</p>
        </div>

        <div class="section">
            <h2>买入信号</h2>
            <p>外部 CSV 列表中的股票且当日未持仓, 卖出后已超过 5 天冷却期</p>
        </div>

        <div class="section">
            <h2>卖出信号</h2>
            <p>持仓股票不在当日 CSV 且距买入≥10 天, 持仓股票不在当日 CSV 且较历史最高价回撤&gt;3% 且当前盈利</p>
        </div>

        <div class="section">
            <h2>仓位管理</h2>
            <p>最多 5 只股票等权；牛市股票 100%，熊市股票 30%+债券 70%；不使用止损，仅用时间/回撤止盈。</p>
        </div>

        <div class="section">
            <h2>交易频率</h2>
            <p>每天运行一次；下单发生在 run_daily(market_open) 14:55。</p>
        </div>

        <div class="section">
            <h2>手动执行指南</h2>
            <p>盘前：生成并上传当日 CSV；盘中：14:54 前保证文件存在；盘后：无操作。</p>
        </div>

        <div class="section">
            <h2>代码审计详情</h2>
            <p>核心选股依赖外部 CSV（未知是否含未来数据）；其余行情函数(attribute_history/get_price)均在回测时间点之后调用，未见明显未来函数。</p>
        </div>

        <div class="section">
            <h2>灰色区域警告</h2>
            <p>外部 CSV 极易在回测时包含未来信息造成幸存者偏差, 分钟级 MA 判断放在 14:55，如果实际生产信号使用全天数据则仍有窥视尾盘风险, 未过滤停牌/ST，实盘易下单失败</p>
        </div>

        <div class="section">
            <h2>执行分析</h2>
            <p>小资金可行，需工程化生成 CSV 与尾盘下单；大资金或高换手情境成本上升。</p>
        </div>

        <div class="section">
            <h2>10万资金场景</h2>
            <p>流动性充裕，尾盘全额成交概率高，滑点忽略不计。</p>
        </div>

        <div class="section">
            <h2>100万资金场景</h2>
            <p>大概率仍能一笔成交，但遇到小盘股需拆单。摩擦成本显著。</p>
        </div>

        <div class="section">
            <h2>1000万资金场景</h2>
            <p>单票 200w 级别，对部分股票冲击较高，需要算法拆单或择券。</p>
        </div>

        <div class="section">
            <h2>1亿资金场景</h2>
            <p>单票过千万，策略容量受限，需要选股信号偏大盘且成交分散，否则滑点失控。</p>
        </div>

        <div class="section">
            <h2>大资金不友好原因</h2>
            <p>最大 5 只股票集中度高，容量有限；尾盘秒杀单冲击明显。</p>
        </div>

        <div class="section">
            <h2>行为偏差利用原因</h2>
            <p>回撤止盈+牛熊动量属于情绪/动量利用，中等强度。</p>
        </div>

        <div class="section">
            <h2>跨阶段稳健性原因</h2>
            <p>收益关键依赖外部多因子 CSV 与分钟级 MA 组合；历史年度收益差异在作者复现时已大幅波动（74%→47%）。</p>
        </div>

        <div class="section">
            <h2>最差环境</h2>
            <p>震荡市且 399008 指数横盘, 因子失效导致外部 CSV 选股错误且频繁换仓</p>
        </div>

        <div class="section">
            <h2>可验证预测</h2>
            <p>牛市判定后次日组合收益应显著高于熊市阶段, 组合净值回撤应受 3% 个股止盈保护影响下降, 牛熊切换日净值波动放大</p>
        </div>

        <div class="section">
            <h2>一句话总结</h2>
            <p>策略结构清晰但盈利核心藏在外部 CSV，未来函数风险需澄清。</p>
        </div>

        <div class="section">
            <h2>优化建议</h2>
            <p>公开或复现选股逻辑并嵌入策略；增加停牌/ST/流动性过滤；对牛熊切换采用多档平滑调仓以降低成本。</p>
        </div>

        <div class="section">
            <h2>假设条件</h2>
            <p>未提供资金规模，以上容量评估以 5 只股票等权假设, 交易成本采用聚宽默认佣金+0.1%印花税模型；无额外滑点模型, 外部 CSV 在 T 日 14:55 前已完整生成且不含未来数据</p>
        </div>

        <div class="section">
            <h2>评分汇总</h2>
            <table>
                <tr><th>指标</th><th>分数</th></tr>
                <tr><td>未来函数风险</td><td>5</td></tr>
                <tr><td>滑点</td><td>4</td></tr>
                <tr><td>成本</td><td>5</td></tr>
                <tr><td>执行难度</td><td>6</td></tr>
                <tr><td>时间敏感性</td><td>6</td></tr>
                <tr><td>综合可执行性</td><td>6.0</td></tr>
                <tr><td>大资金不友好</td><td>6</td></tr>
                <tr><td>行为偏差利用</td><td>5</td></tr>
                <tr><td>跨阶段稳健性</td><td>4</td></tr>
                <tr><td>有效性总分</td><td>4.9</td></tr>
                <tr><td>总分</td><td>54.1</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>原始AI响应</h2>
            <pre>```json
{
    &quot;strategy_name&quot;: &quot;外部信号+股债动态平衡5股组合&quot;,
    &quot;strategy_type&quot;: &quot;多因子选股+趋势跟踪&quot;,
    
    &quot;strategy_explanation&quot;: {
        &quot;core_logic&quot;: &quot;1) 选股完全依赖盘前产出的外部 CSV 文件（未知算法）给出当日候选股票；2) 盘中 14:55 读取文件后，对比当前持仓与买入列表做增删；3) 同时用中证 1000-指数(399008) 的分钟级动量(MA10) 判断牛熊并控制股票/债券(511010) 仓位比例：牛市股票 100%，熊市股票 30%+债券 70%；4) 单只股票持有过程中若从历史最高价回撤 &gt;3% 且已不在买入列表, 或已持有≥10天且不在买入列表则清仓；5) 为避免来回交易，同一股票卖出后 5 天内禁止再次买入。&quot;,
        &quot;data_and_indicators&quot;: &quot;价格(分钟/日)、指数历史收盘价、外部生成的选股信号 CSV。所有指标均为行情数据；无财务因子直接使用。&quot;,
        &quot;stock_pool&quot;: &quot;未在代码中限制；默认全 A 股（可能包含 ST/停牌/次新）；仅通过聚宽撮合规则自动排除停牌、涨跌停。&quot;,
        &quot;buy_signals&quot;: [&quot;外部 CSV 列表中的股票且当日未持仓&quot;, &quot;卖出后已超过 5 天冷却期&quot;],
        &quot;sell_signals&quot;: [&quot;持仓股票不在当日 CSV 且距买入≥10 天&quot;, &quot;持仓股票不在当日 CSV 且较历史最高价回撤&gt;3% 且当前盈利&quot;],
        &quot;position_and_risk&quot;: &quot;最多 5 只股票等权；牛市股票 100%，熊市股票 30%+债券 70%；不使用止损，仅用时间/回撤止盈。&quot;,
        &quot;trading_frequency&quot;: &quot;每天运行一次；下单发生在 run_daily(market_open) 14:55。&quot;,
        &quot;manual_execution_guide&quot;: &quot;盘前：生成并上传当日 CSV；盘中：14:54 前保证文件存在；盘后：无操作。&quot;
    },
    
    &quot;future_function_detection&quot;: {
        &quot;has_future_function&quot;: &quot;不确定&quot;,
        &quot;risk_level&quot;: &quot;中&quot;,
        &quot;risk_score&quot;: 5,
        &quot;risk_score_reason&quot;: &quot;核心选股依赖外部 CSV（未知是否含未来数据）；其余行情函数(attribute_history/get_price)均在回测时间点之后调用，未见明显未来函数。&quot;,
        &quot;detailed_analysis&quot;: {
            &quot;price_data_leak&quot;: &quot;attribute_history/get_price 均使用当前时间窗口以前的数据，暂未发现越界调用。&quot;,
            &quot;financial_data_leak&quot;: &quot;未调用财务数据接口，风险为无。&quot;,
            &quot;index_component_leak&quot;: &quot;无成分股处理逻辑。&quot;,
            &quot;backtest_engine_leak&quot;: &quot;使用 context.previous_date、attribute_history 等标准 API，未见绕开回测限制的代码。&quot;
        },
        &quot;fix_suggestions&quot;: &quot;披露或开源 CSV 生成脚本；在回测中用 run_file_reader() 生成实时文件而非预置整段历史文件，可降低未来数据嵌入风险。&quot;,
        &quot;gray_area_warnings&quot;: [&quot;外部 CSV 极易在回测时包含未来信息造成幸存者偏差&quot;, &quot;分钟级 MA 判断放在 14:55，如果实际生产信号使用全天数据则仍有窥视尾盘风险&quot;, &quot;未过滤停牌/ST，实盘易下单失败&quot;]
    },
    
    &quot;execution_difficulty&quot;: {
        &quot;slippage_score&quot;: 4,
        &quot;slippage_reason&quot;: &quot;日内尾盘成交，避开开盘抢单但仍可能遇到收盘前流动性收敛；5 只股票等权，影响有限。&quot;,
        &quot;cost_score&quot;: 5,
        &quot;cost_reason&quot;: &quot;几乎每日调仓，且牛熊切换时全仓比例调节；年化换手中偏上。&quot;,
        &quot;execution_score&quot;: 6,
        &quot;execution_reason&quot;: &quot;单票价值按可用现金/剩余名额下单，小规模较易成交，但未处理涨停/停牌重试。&quot;,
        &quot;time_sensitivity_score&quot;: 6,
        &quot;time_sensitivity_reason&quot;: &quot;需要在 14:55 精确执行牛熊判断与调仓。&quot;,
        &quot;overall_executability&quot;: 6,
        &quot;overall_reason&quot;: &quot;小资金可行，需工程化生成 CSV 与尾盘下单；大资金或高换手情境成本上升。&quot;,
        &quot;scenario_analysis&quot;: {
            &quot;10w&quot;: &quot;流动性充裕，尾盘全额成交概率高，滑点忽略不计。&quot;,
            &quot;100w&quot;: &quot;大概率仍能一笔成交，但遇到小盘股需拆单。摩擦成本显著。&quot;,
            &quot;1000w&quot;: &quot;单票 200w 级别，对部分股票冲击较高，需要算法拆单或择券。&quot;,
            &quot;1y&quot;: &quot;单票过千万，策略容量受限，需要选股信号偏大盘且成交分散，否则滑点失控。&quot;
        },
        &quot;improvement_suggestions&quot;: [&quot;在选股阶段加入流动性/市值过滤&quot;, &quot;使用 VWAP 或 TWAP 拆单降低尾盘冲击&quot;]
    },
    
    &quot;effectiveness&quot;: {
        &quot;large_fund_unfriendly_score&quot;: 6,
        &quot;large_fund_unfriendly_reason&quot;: &quot;最大 5 只股票集中度高，容量有限；尾盘秒杀单冲击明显。&quot;,
        &quot;behavioral_bias_score&quot;: 5,
        &quot;behavioral_bias_reason&quot;: &quot;回撤止盈+牛熊动量属于情绪/动量利用，中等强度。&quot;,
        &quot;cross_period_robustness_score&quot;: 4,
        &quot;cross_period_robustness_reason&quot;: &quot;收益关键依赖外部多因子 CSV 与分钟级 MA 组合；历史年度收益差异在作者复现时已大幅波动（74%→47%）。&quot;,
        &quot;effectiveness_total_score&quot;: 4.9,
        &quot;weight_explanation&quot;: &quot;大资金不友好40%+行为偏差30%+跨阶段稳健30%&quot;,
        &quot;worst_environments&quot;: [&quot;震荡市且 399008 指数横盘&quot;,&quot;因子失效导致外部 CSV 选股错误且频繁换仓&quot;],
        &quot;verifiable_predictions&quot;: [&quot;牛市判定后次日组合收益应显著高于熊市阶段&quot;,&quot;组合净值回撤应受 3% 个股止盈保护影响下降&quot;,&quot;牛熊切换日净值波动放大&quot;]
    },
    
    &quot;conclusion&quot;: {
        &quot;verdict&quot;: &quot;策略结构清晰但盈利核心藏在外部 CSV，未来函数风险需澄清。&quot;,
        &quot;recommendation&quot;: &quot;小仓实测&quot;,
        &quot;optimization_suggestions&quot;: &quot;公开或复现选股逻辑并嵌入策略；增加停牌/ST/流动性过滤；对牛熊切换采用多档平滑调仓以降低成本。&quot;
    },
    
    &quot;score_summary&quot;: {
        &quot;future_function_risk&quot;: 5,
        &quot;slippage&quot;: 4,
        &quot;cost&quot;: 5,
        &quot;execution&quot;: 6,
        &quot;time_sensitivity&quot;: 6,
        &quot;executability&quot;: 6,
        &quot;effectiveness_a&quot;: 6,
        &quot;effectiveness_b&quot;: 5,
        &quot;effectiveness_c&quot;: 4,
        &quot;effectiveness_total&quot;: 4.9
    },
    
    &quot;assumptions&quot;: [
        &quot;未提供资金规模，以上容量评估以 5 只股票等权假设&quot;,
        &quot;交易成本采用聚宽默认佣金+0.1%印花税模型；无额外滑点模型&quot;,
        &quot;外部 CSV 在 T 日 14:55 前已完整生成且不含未来数据&quot;
    ]
}
```</pre>
        </div>

    </div>
</body>
</html>