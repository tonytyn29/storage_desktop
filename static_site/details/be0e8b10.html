<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ETF动量+MA乖离择时轮动 - 策略详情</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 30px;
            line-height: 1.8;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .meta { color: #888; margin-bottom: 30px; font-size: 0.9rem; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h2 {
            font-size: 1.2rem;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section p, .section pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #ccc;
        }
        pre {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .back-btn:hover { opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(0,0,0,0.2); color: #00d4ff; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">← 返回列表</a>
        <h1>ETF动量+MA乖离择时轮动</h1>
        <p class="meta">
            ID: be0e8b10 | 
            类型: 动量策略 | 
            来源: b2324_66.ETF动量轮动MA乖离择时.txt |
            分析日期: 2026-01-11 18:24:50
        </p>

        <div class="section">
            <h2>策略逻辑概要</h2>
            <p>在一小撮高流动性ETF之间做短周期（20 日）动量排序，只持有动量最强的 1 只；同时用 CSI300 指数相对 60 日均线的 10 日均线乖离做大盘择时，过度高估时空仓，过度低估时加仓或持仓；辅以 10% 浮亏止损。</p>
        </div>

        <div class="section">
            <h2>股票池</h2>
            <p>固定 4 支场内 ETF：510050、159928、510300、159949；无 ST/停牌/上市天数过滤；不对成分股、规模或流动性再筛选。</p>
        </div>

        <div class="section">
            <h2>买入信号</h2>
            <p>择时信号为 BUY 或 KEEP（z-score ≥ −4）, 20 日动量斜率排名第 1 的 ETF</p>
        </div>

        <div class="section">
            <h2>卖出信号</h2>
            <p>择时信号为 SELL（z-score ≤ −4）—— 全部清仓, 10% 浮亏止损</p>
        </div>

        <div class="section">
            <h2>仓位管理</h2>
            <p>最多持 1 只 ETF，满仓/空仓两档；仓位只在空→满或满→空之间切换；止损触发时把该 ETF 清仓；不使用资金管理或分级杠杆。</p>
        </div>

        <div class="section">
            <h2>交易频率</h2>
            <p>run_daily 在 14:50 调仓，如果信号未变则可能数周不交易；09:30 check_lose 执行止损。</p>
        </div>

        <div class="section">
            <h2>手动执行指南</h2>
            <p>14:45-14:50 观察 CSI300 当日实时价、计算乖离 z-score，若&gt;4 光标停留买入逻辑对应 ETF；若&lt;-4 则卖出所有仓位。持仓后每天开盘检查是否浮亏&gt;10%，若是则开盘价附近止损。</p>
        </div>

        <div class="section">
            <h2>代码审计详情</h2>
            <p>所有指标通过 attribute_history/rolling 只用已产生的日线；set_option(&#x27;avoid_future_data&#x27;,True) 已开启。</p>
        </div>

        <div class="section">
            <h2>灰色区域警告</h2>
            <p>盘中使用实时价与回测的收盘价差异会导致回测-实盘跟踪误差, 动量检测窗口与择时阈值未做显著检验，可能隐含数据挖掘, 固定 ETF 池过窄，策略易受单只 ETF 失效影响</p>
        </div>

        <div class="section">
            <h2>执行分析</h2>
            <p>低换手+高流动性 + 宽松时效。</p>
        </div>

        <div class="section">
            <h2>10万资金场景</h2>
            <p>几乎无冲击，满仓一笔搞定</p>
        </div>

        <div class="section">
            <h2>100万资金场景</h2>
            <p>同上</p>
        </div>

        <div class="section">
            <h2>1000万资金场景</h2>
            <p>仍 &lt; 千分之一成交额，影响可忽略</p>
        </div>

        <div class="section">
            <h2>1亿资金场景</h2>
            <p>占成交额约 1%，需分批但仍可执行</p>
        </div>

        <div class="section">
            <h2>大资金不友好原因</h2>
            <p>标的为高容量 ETF，容量&gt;百亿</p>
        </div>

        <div class="section">
            <h2>行为偏差利用原因</h2>
            <p>利用动量及情绪高低估（MA 乖离）属于中度行为偏差捕捉</p>
        </div>

        <div class="section">
            <h2>跨阶段稳健性原因</h2>
            <p>动量+单一阈值乖离未经多周期验证，稳健性一般</p>
        </div>

        <div class="section">
            <h2>最差环境</h2>
            <p>无明显趋势且频繁震荡的市场, 指数快速 V 形反转导致高乖离信号错杀</p>
        </div>

        <div class="section">
            <h2>可验证预测</h2>
            <p>动量最强 ETF 在随后 1-4 周跑赢其余 3 只, 当 CSI300 z-score&lt;-4 后 20 个交易日内平均收益为正, SELL 信号历史回测中持币期波动明显低于持仓期</p>
        </div>

        <div class="section">
            <h2>一句话总结</h2>
            <p>简洁易行、容量大的 ETF 轮动策略，未来函数风险低，但择时阈值与池子偏简单，长期稳健性存疑。</p>
        </div>

        <div class="section">
            <h2>优化建议</h2>
            <p>（1）对择时阈值做 Walk-Forward 优化；（2）扩大并动态筛选 ETF 池；（3）将动量窗口与仓位比例做动态调整</p>
        </div>

        <div class="section">
            <h2>假设条件</h2>
            <p>未给出初始资金，假设 100 万人民币，以便估算交易成本, 未说明滑点模型，沿用代码 set_slippage(FixedSlippage(0.1%)), 默认全部指令以市价成交，忽略涨跌停限制（ETF 极少触及涨跌停）</p>
        </div>

        <div class="section">
            <h2>评分汇总</h2>
            <table>
                <tr><th>指标</th><th>分数</th></tr>
                <tr><td>未来函数风险</td><td>2</td></tr>
                <tr><td>滑点</td><td>2</td></tr>
                <tr><td>成本</td><td>2</td></tr>
                <tr><td>执行难度</td><td>9</td></tr>
                <tr><td>时间敏感性</td><td>4</td></tr>
                <tr><td>综合可执行性</td><td>6.9</td></tr>
                <tr><td>大资金不友好</td><td>2</td></tr>
                <tr><td>行为偏差利用</td><td>5</td></tr>
                <tr><td>跨阶段稳健性</td><td>5</td></tr>
                <tr><td>有效性总分</td><td>3.9</td></tr>
                <tr><td>总分</td><td>52.6</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>原始AI响应</h2>
            <pre>```json
{
    &quot;strategy_name&quot;: &quot;ETF动量+MA乖离择时轮动&quot;,
    &quot;strategy_type&quot;: &quot;动量策略&quot;,
    
    &quot;strategy_explanation&quot;: {
        &quot;core_logic&quot;: &quot;在一小撮高流动性ETF之间做短周期（20 日）动量排序，只持有动量最强的 1 只；同时用 CSI300 指数相对 60 日均线的 10 日均线乖离做大盘择时，过度高估时空仓，过度低估时加仓或持仓；辅以 10% 浮亏止损。&quot;,
        &quot;data_and_indicators&quot;: &quot;（1）ETF 和指数的日收盘价（use_real_price=True，因此盘中实时更新）；（2）20 日线性回归斜率作为动量；（3）CSI300 收盘价对 60 日均线的乖离率及其 10 日均线；（4）z-score 标准化近 30 日乖离均线作为择时因子。&quot;,
        &quot;stock_pool&quot;: &quot;固定 4 支场内 ETF：510050、159928、510300、159949；无 ST/停牌/上市天数过滤；不对成分股、规模或流动性再筛选。&quot;,
        &quot;buy_signals&quot;: [
            &quot;择时信号为 BUY 或 KEEP（z-score ≥ −4）&quot;,
            &quot;20 日动量斜率排名第 1 的 ETF&quot;
        ],
        &quot;sell_signals&quot;: [
            &quot;择时信号为 SELL（z-score ≤ −4）—— 全部清仓&quot;,
            &quot;10% 浮亏止损&quot;
        ],
        &quot;position_and_risk&quot;: &quot;最多持 1 只 ETF，满仓/空仓两档；仓位只在空→满或满→空之间切换；止损触发时把该 ETF 清仓；不使用资金管理或分级杠杆。&quot;,
        &quot;trading_frequency&quot;: &quot;run_daily 在 14:50 调仓，如果信号未变则可能数周不交易；09:30 check_lose 执行止损。&quot;,
        &quot;manual_execution_guide&quot;: &quot;14:45-14:50 观察 CSI300 当日实时价、计算乖离 z-score，若&gt;4 光标停留买入逻辑对应 ETF；若&lt;-4 则卖出所有仓位。持仓后每天开盘检查是否浮亏&gt;10%，若是则开盘价附近止损。&quot;
    },
    
    &quot;future_function_detection&quot;: {
        &quot;has_future_function&quot;: &quot;否&quot;,
        &quot;risk_level&quot;: &quot;低&quot;,
        &quot;risk_score&quot;: 2,
        &quot;risk_score_reason&quot;: &quot;所有指标通过 attribute_history/rolling 只用已产生的日线；set_option(&#x27;avoid_future_data&#x27;,True) 已开启。&quot;,
        &quot;detailed_analysis&quot;: {
            &quot;price_data_leak&quot;: &quot;attribute_history(…,‘1d’) 在盘中取值为当日实时价而非未收盘价，属实时数据，不是未来数据&quot;,
            &quot;financial_data_leak&quot;: &quot;未使用财务数据&quot;,
            &quot;index_component_leak&quot;: &quot;未引用未来成分&quot;,
            &quot;backtest_engine_leak&quot;: &quot;无&quot;
        },
        &quot;fix_suggestions&quot;: &quot;如需完全规避盘中未来价，可将计算改到收盘后 next_day_open 执行。&quot;,
        &quot;gray_area_warnings&quot;: [
            &quot;盘中使用实时价与回测的收盘价差异会导致回测-实盘跟踪误差&quot;,
            &quot;动量检测窗口与择时阈值未做显著检验，可能隐含数据挖掘&quot;,
            &quot;固定 ETF 池过窄，策略易受单只 ETF 失效影响&quot;
        ]
    },
    
    &quot;execution_difficulty&quot;: {
        &quot;slippage_score&quot;: 2,
        &quot;slippage_reason&quot;: &quot;目标 ETF 日均成交额数十亿，14:50 下单冲击极低；策略日内只有 0-1 笔成交。&quot;,
        &quot;cost_score&quot;: 2,
        &quot;cost_reason&quot;: &quot;满仓/空仓切换，周-月级换手；基金费率按 0.03% 计，年化成本极低。&quot;,
        &quot;execution_score&quot;: 9,
        &quot;execution_reason&quot;: &quot;仅交易大盘 ETF，流动性充裕；不需要拆单。&quot;,
        &quot;time_sensitivity_score&quot;: 4,
        &quot;time_sensitivity_reason&quot;: &quot;信号在 14:50 计算，需要当日收盘前完成；分钟级即可。&quot;,
        &quot;overall_executability&quot;: 9,
        &quot;overall_reason&quot;: &quot;低换手+高流动性 + 宽松时效。&quot;,
        &quot;scenario_analysis&quot;: {
            &quot;10w&quot;: &quot;几乎无冲击，满仓一笔搞定&quot;,
            &quot;100w&quot;: &quot;同上&quot;,
            &quot;1000w&quot;: &quot;仍 &lt; 千分之一成交额，影响可忽略&quot;,
            &quot;1y&quot;: &quot;占成交额约 1%，需分批但仍可执行&quot;
        },
        &quot;improvement_suggestions&quot;: [
            &quot;在调整仓位时使用 VWAP 或 TWAP 避免尾盘集合冲击&quot;,
            &quot;扩展 ETF 池并引入流动性过滤，提升稳健性&quot;
        ]
    },
    
    &quot;effectiveness&quot;: {
        &quot;large_fund_unfriendly_score&quot;: 2,
        &quot;large_fund_unfriendly_reason&quot;: &quot;标的为高容量 ETF，容量&gt;百亿&quot;,
        &quot;behavioral_bias_score&quot;: 5,
        &quot;behavioral_bias_reason&quot;: &quot;利用动量及情绪高低估（MA 乖离）属于中度行为偏差捕捉&quot;,
        &quot;cross_period_robustness_score&quot;: 5,
        &quot;cross_period_robustness_reason&quot;: &quot;动量+单一阈值乖离未经多周期验证，稳健性一般&quot;,
        &quot;effectiveness_total_score&quot;: 6.0,
        &quot;weight_explanation&quot;: &quot;大资金友好20%+行为偏差30%+跨阶段稳健50%&quot;,
        &quot;worst_environments&quot;: [
            &quot;无明显趋势且频繁震荡的市场&quot;,
            &quot;指数快速 V 形反转导致高乖离信号错杀&quot;
        ],
        &quot;verifiable_predictions&quot;: [
            &quot;动量最强 ETF 在随后 1-4 周跑赢其余 3 只&quot;,
            &quot;当 CSI300 z-score&lt;-4 后 20 个交易日内平均收益为正&quot;,
            &quot;SELL 信号历史回测中持币期波动明显低于持仓期&quot;
        ]
    },
    
    &quot;conclusion&quot;: {
        &quot;verdict&quot;: &quot;简洁易行、容量大的 ETF 轮动策略，未来函数风险低，但择时阈值与池子偏简单，长期稳健性存疑。&quot;,
        &quot;recommendation&quot;: &quot;小仓实测&quot;,
        &quot;optimization_suggestions&quot;: &quot;（1）对择时阈值做 Walk-Forward 优化；（2）扩大并动态筛选 ETF 池；（3）将动量窗口与仓位比例做动态调整&quot;
    },
    
    &quot;score_summary&quot;: {
        &quot;future_function_risk&quot;: 2,
        &quot;slippage&quot;: 2,
        &quot;cost&quot;: 2,
        &quot;execution&quot;: 9,
        &quot;time_sensitivity&quot;: 4,
        &quot;executability&quot;: 9,
        &quot;effectiveness_a&quot;: 2,
        &quot;effectiveness_b&quot;: 5,
        &quot;effectiveness_c&quot;: 5,
        &quot;effectiveness_total&quot;: 6.0
    },
    
    &quot;assumptions&quot;: [
        &quot;未给出初始资金，假设 100 万人民币，以便估算交易成本&quot;,
        &quot;未说明滑点模型，沿用代码 set_slippage(FixedSlippage(0.1%))&quot;,
        &quot;默认全部指令以市价成交，忽略涨跌停限制（ETF 极少触及涨跌停）&quot;
    ]
}
```</pre>
        </div>

    </div>
</body>
</html>