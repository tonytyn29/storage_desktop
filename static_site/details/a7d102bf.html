<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>三连阳趋势+PE过滤 - 策略详情</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 30px;
            line-height: 1.8;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .meta { color: #888; margin-bottom: 30px; font-size: 0.9rem; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h2 {
            font-size: 1.2rem;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section p, .section pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #ccc;
        }
        pre {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .back-btn:hover { opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(0,0,0,0.2); color: #00d4ff; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">← 返回列表</a>
        <h1>三连阳趋势+PE过滤</h1>
        <p class="meta">
            ID: a7d102bf | 
            类型: 动量/趋势跟踪 + 简单基本面过滤 | 
            来源: b2324_97.韶华研究之六，简单不一样的发现趋势，3年6倍.txt |
            分析日期: 2026-01-11 18:35:04
        </p>

        <div class="section">
            <h2>策略逻辑概要</h2>
            <p>在月线级别（默认）寻找连续三个上涨月，且每月收盘价至少高于开盘价5%，认为该股处于明显上升趋势；再用 PE 由低到高排序，选出前 N 支（默认 5 支）等权买入。依靠强势股续涨与风险控制（高点回落 20% 动态止损）获取超额收益。</p>
        </div>

        <div class="section">
            <h2>股票池</h2>
            <p>先取沪深300成分（可改为全部A股），剔除停牌/ST/带“退”及上市未满一年公司。</p>
        </div>

        <div class="section">
            <h2>买入信号</h2>
            <p>满足连续 g.up_num(=3) 根月阳线且单月涨幅&gt;5%, PE 为正并在所有候选中最小的前 g.stocknum(=5) 名</p>
        </div>

        <div class="section">
            <h2>卖出信号</h2>
            <p>月度调仓时：不在最新 buylist 的个股全部清仓, 日内动态止损：最近收盘价较过去 10 日最高价回撤&gt;20% 时清仓</p>
        </div>

        <div class="section">
            <h2>仓位管理</h2>
            <p>等权分配，持股数默认 5 只；止损分级可选。触发止损后是否补仓由 g.position_balance 控制（默认不补）。</p>
        </div>

        <div class="section">
            <h2>交易频率</h2>
            <p>月初第一个交易日 09:30 调仓；止损检查每日 09:30 执行。</p>
        </div>

        <div class="section">
            <h2>手动执行指南</h2>
            <p>盘前：运行选股逻辑确定 buylist；开盘后立即下单等权买入；持仓期间每日早盘检查止损后先卖再视需要均衡补仓。</p>
        </div>

        <div class="section">
            <h2>代码审计详情</h2>
            <p>所有调用均显式使用 context.previous_date 或默认取截止上日收盘的数据；未发现 get_price(end_date=None) 等明显未来函数。</p>
        </div>

        <div class="section">
            <h2>灰色区域警告</h2>
            <p>月初 07:00 调用 get_bars(unit=&#x27;1M&#x27;) 依赖聚宽对未收盘月的处理规则，建议确认月线是否已经封闭。</p>
        </div>

        <div class="section">
            <h2>执行分析</h2>
            <p>中低频+大盘股，10–1000 万规模可直接市场委托。</p>
        </div>

        <div class="section">
            <h2>10万资金场景</h2>
            <p>资金远小于单只股票早盘量，几乎无冲击。</p>
        </div>

        <div class="section">
            <h2>100万资金场景</h2>
            <p>等权每只≈20w，依旧轻松。</p>
        </div>

        <div class="section">
            <h2>1000万资金场景</h2>
            <p>等权每只≈200w，沪深300成分依旧可行，需分批下单。</p>
        </div>

        <div class="section">
            <h2>1亿资金场景</h2>
            <p>等权每只≈2,000w，部分成份股盘口可能有冲击，但仍可通过 VWAP 分批完成。</p>
        </div>

        <div class="section">
            <h2>大资金不友好原因</h2>
            <p>持股集中度高(5 只)但均为权重股，容量尚可；&gt;10 亿时存在冲击。</p>
        </div>

        <div class="section">
            <h2>行为偏差利用原因</h2>
            <p>连阳+动量捕捉市场情绪，利用趋势和机构调仓慢反应。</p>
        </div>

        <div class="section">
            <h2>跨阶段稳健性原因</h2>
            <p>规则简单，但依赖趋势市；震荡市下性能堪忧。</p>
        </div>

        <div class="section">
            <h2>最差环境</h2>
            <p>宽幅震荡无趋势, 急速单日反转导致高位买入后大幅回撤</p>
        </div>

        <div class="section">
            <h2>可验证预测</h2>
            <p>连续 3 个月上涨并且 PE 较低的股票接下来 1 个月超越沪深300, 高点回落 20% 后继续持有的概率低，止损可减少极端亏损, 在牛市前期选股成功率高于熊市</p>
        </div>

        <div class="section">
            <h2>一句话总结</h2>
            <p>简洁的月线动量策略，代码合规、执行易，但对市场趋势敏感。</p>
        </div>

        <div class="section">
            <h2>优化建议</h2>
            <p>引入多因子质量/估值过滤、动态持股数、对止损后空仓的资金再分配逻辑做回测</p>
        </div>

        <div class="section">
            <h2>假设条件</h2>
            <p>未提供资金规模，分析假设基准 100 万元, 滑点模型采用聚宽默认（0），实盘需调整</p>
        </div>

        <div class="section">
            <h2>评分汇总</h2>
            <table>
                <tr><th>指标</th><th>分数</th></tr>
                <tr><td>未来函数风险</td><td>2</td></tr>
                <tr><td>滑点</td><td>4</td></tr>
                <tr><td>成本</td><td>3</td></tr>
                <tr><td>执行难度</td><td>8</td></tr>
                <tr><td>时间敏感性</td><td>3</td></tr>
                <tr><td>综合可执行性</td><td>6.3</td></tr>
                <tr><td>大资金不友好</td><td>5</td></tr>
                <tr><td>行为偏差利用</td><td>6</td></tr>
                <tr><td>跨阶段稳健性</td><td>5</td></tr>
                <tr><td>有效性总分</td><td>5.2</td></tr>
                <tr><td>总分</td><td>56.7</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>原始AI响应</h2>
            <pre>```json
{
    &quot;strategy_name&quot;: &quot;三连阳趋势+PE过滤&quot;,
    &quot;strategy_type&quot;: &quot;动量/趋势跟踪 + 简单基本面过滤&quot;,
    
    &quot;strategy_explanation&quot;: {
        &quot;core_logic&quot;: &quot;在月线级别（默认）寻找连续三个上涨月，且每月收盘价至少高于开盘价5%，认为该股处于明显上升趋势；再用 PE 由低到高排序，选出前 N 支（默认 5 支）等权买入。依靠强势股续涨与风险控制（高点回落 20% 动态止损）获取超额收益。&quot;,
        &quot;data_and_indicators&quot;: &quot;1) 价格数据:get_bars(月线/周线)、get_price(日线)；2) 实时属性:get_current_data(停牌/ST)；3) 财务数据:get_fundamentals(valuation.pe_ratio)。均为聚宽历史接口，每日/每月在盘前更新。&quot;,
        &quot;stock_pool&quot;: &quot;先取沪深300成分（可改为全部A股），剔除停牌/ST/带“退”及上市未满一年公司。&quot;,
        &quot;buy_signals&quot;: [&quot;满足连续 g.up_num(=3) 根月阳线且单月涨幅&gt;5%&quot;, &quot;PE 为正并在所有候选中最小的前 g.stocknum(=5) 名&quot;],
        &quot;sell_signals&quot;: [&quot;月度调仓时：不在最新 buylist 的个股全部清仓&quot;, &quot;日内动态止损：最近收盘价较过去 10 日最高价回撤&gt;20% 时清仓&quot;],
        &quot;position_and_risk&quot;: &quot;等权分配，持股数默认 5 只；止损分级可选。触发止损后是否补仓由 g.position_balance 控制（默认不补）。&quot;,
        &quot;trading_frequency&quot;: &quot;月初第一个交易日 09:30 调仓；止损检查每日 09:30 执行。&quot;,
        &quot;manual_execution_guide&quot;: &quot;盘前：运行选股逻辑确定 buylist；开盘后立即下单等权买入；持仓期间每日早盘检查止损后先卖再视需要均衡补仓。&quot;
    },
    
    &quot;future_function_detection&quot;: {
        &quot;has_future_function&quot;: &quot;否&quot;,
        &quot;risk_level&quot;: &quot;低&quot;,
        &quot;risk_score&quot;: 2,
        &quot;risk_score_reason&quot;: &quot;所有调用均显式使用 context.previous_date 或默认取截止上日收盘的数据；未发现 get_price(end_date=None) 等明显未来函数。&quot;,
        &quot;detailed_analysis&quot;: {
            &quot;price_data_leak&quot;: &quot;get_bars / get_price 在 before_market_open_timely 使用默认 end_dt=当前日期，但月线上一根 K 线在上月末已收盘，不构成未来泄漏；止损函数显式指定 end_date=lastd_date。&quot;,
            &quot;financial_data_leak&quot;: &quot;get_fundamentals(…, lastd_date) 明确用上日数据。&quot;,
            &quot;index_component_leak&quot;: &quot;get_index_stocks 默认返回昨日收盘时的权重，不涉及未来。&quot;,
            &quot;backtest_engine_leak&quot;: &quot;未见使用 pipeline 或写文件再读取等回测穿透手段。&quot;
        },
        &quot;fix_suggestions&quot;: &quot;保持现状即可；若担心接口默认行为，可统一加 end_dt=context.previous_date。&quot;,
        &quot;gray_area_warnings&quot;: [&quot;月初 07:00 调用 get_bars(unit=&#x27;1M&#x27;) 依赖聚宽对未收盘月的处理规则，建议确认月线是否已经封闭。&quot;]
    },
    
    &quot;execution_difficulty&quot;: {
        &quot;slippage_score&quot;: 4,
        &quot;slippage_reason&quot;: &quot;月度、等权、个股数量≤5，且多为沪深300成份股，使用市价成交；一般滑点中等。&quot;,
        &quot;cost_score&quot;: 3,
        &quot;cost_reason&quot;: &quot;月度换手+偶发止损，预计年换手 &lt;12 次/股；佣金+印花税在聚宽默认费率下较低。&quot;,
        &quot;execution_score&quot;: 8,
        &quot;execution_reason&quot;: &quot;标的流动性好、数量少、首次开盘即可成交。&quot;,
        &quot;time_sensitivity_score&quot;: 3,
        &quot;time_sensitivity_reason&quot;: &quot;调仓与止损均在 09:30 下单，错过几分钟影响有限。&quot;,
        &quot;overall_executability&quot;: 8,
        &quot;overall_reason&quot;: &quot;中低频+大盘股，10–1000 万规模可直接市场委托。&quot;,
        &quot;scenario_analysis&quot;: {
            &quot;10w&quot;: &quot;资金远小于单只股票早盘量，几乎无冲击。&quot;,
            &quot;100w&quot;: &quot;等权每只≈20w，依旧轻松。&quot;,
            &quot;1000w&quot;: &quot;等权每只≈200w，沪深300成分依旧可行，需分批下单。&quot;,
            &quot;1y&quot;: &quot;等权每只≈2,000w，部分成份股盘口可能有冲击，但仍可通过 VWAP 分批完成。&quot;
        },
        &quot;improvement_suggestions&quot;: [&quot;将下单拆分为多笔 VWAP 以降低冲击&quot;, &quot;增加滑点容忍度测试，评估不同资金量下的容量&quot;]
    },
    
    &quot;effectiveness&quot;: {
        &quot;large_fund_unfriendly_score&quot;: 5,
        &quot;large_fund_unfriendly_reason&quot;: &quot;持股集中度高(5 只)但均为权重股，容量尚可；&gt;10 亿时存在冲击。&quot;,
        &quot;behavioral_bias_score&quot;: 6,
        &quot;behavioral_bias_reason&quot;: &quot;连阳+动量捕捉市场情绪，利用趋势和机构调仓慢反应。&quot;,
        &quot;cross_period_robustness_score&quot;: 5,
        &quot;cross_period_robustness_reason&quot;: &quot;规则简单，但依赖趋势市；震荡市下性能堪忧。&quot;,
        &quot;effectiveness_total_score&quot;: 5.3,
        &quot;weight_explanation&quot;: &quot;大资金不友好40%+行为偏差30%+跨阶段稳健30%&quot;,
        &quot;worst_environments&quot;: [&quot;宽幅震荡无趋势&quot;, &quot;急速单日反转导致高位买入后大幅回撤&quot;],
        &quot;verifiable_predictions&quot;: [&quot;连续 3 个月上涨并且 PE 较低的股票接下来 1 个月超越沪深300&quot;, &quot;高点回落 20% 后继续持有的概率低，止损可减少极端亏损&quot;, &quot;在牛市前期选股成功率高于熊市&quot;]
    },
    
    &quot;conclusion&quot;: {
        &quot;verdict&quot;: &quot;简洁的月线动量策略，代码合规、执行易，但对市场趋势敏感。&quot;,
        &quot;recommendation&quot;: &quot;小仓实测&quot;,
        &quot;optimization_suggestions&quot;: &quot;引入多因子质量/估值过滤、动态持股数、对止损后空仓的资金再分配逻辑做回测&quot;
    },
    
    &quot;score_summary&quot;: {
        &quot;future_function_risk&quot;: 2,
        &quot;slippage&quot;: 4,
        &quot;cost&quot;: 3,
        &quot;execution&quot;: 8,
        &quot;time_sensitivity&quot;: 3,
        &quot;executability&quot;: 8,
        &quot;effectiveness_a&quot;: 5,
        &quot;effectiveness_b&quot;: 6,
        &quot;effectiveness_c&quot;: 5,
        &quot;effectiveness_total&quot;: 5.3
    },
    
    &quot;assumptions&quot;: [&quot;未提供资金规模，分析假设基准 100 万元&quot;, &quot;滑点模型采用聚宽默认（0），实盘需调整&quot;]
}
```</pre>
        </div>

    </div>
</body>
</html>