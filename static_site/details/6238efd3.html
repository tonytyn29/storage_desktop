<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>券商金股 周频动量增强 - 策略详情</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 30px;
            line-height: 1.8;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .meta { color: #888; margin-bottom: 30px; font-size: 0.9rem; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h2 {
            font-size: 1.2rem;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section p, .section pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #ccc;
        }
        pre {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .back-btn:hover { opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(0,0,0,0.2); color: #00d4ff; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">← 返回列表</a>
        <h1>券商金股 周频动量增强</h1>
        <p class="meta">
            ID: 6238efd3 | 
            类型: 多因子选股 + 动量 | 
            来源: b2324_55.【分享】券商金股组合增强.txt |
            分析日期: 2026-01-11 18:21:35
        </p>

        <div class="section">
            <h2>策略逻辑概要</h2>
            <p>先利用券商每月发布的“金股”列表作为基本池，假设这些股票已被基本面研究筛过；再用振幅、聪明钱(Q)和中长期动量(RM)三类高频/中频价格-量因子对池内股票做横截面打分，每周把综合得分最高的15只股票买入（或保持）；若启用组合优化，则在给定历史窗（默认120 交易日）内求最优权重（MaxProfit/MaxSharpe 等）。思路是：用卖方研究挖掘“好公司”+用市场行为因子择时加仓，力图同时获取基本面 β 与行为 α。</p>
        </div>

        <div class="section">
            <h2>股票池</h2>
            <p>对券商月度金股做一次性过滤：排除尾码 HK 的港股；未显式过滤 ST/停牌/次新等，仅在计算因子时用 paused 字段剔除一字跌停。实际下单前未二次校验涨跌停、停牌。</p>
        </div>

        <div class="section">
            <h2>买入信号</h2>
            <p>当周第 5 个交易日开盘，等权因子分数 (AF+Q+RM) 排名前 15 的股票, 若开启组合优化，则买入优化器给出的正权重股票</p>
        </div>

        <div class="section">
            <h2>卖出信号</h2>
            <p>不在最新一周目标列表/权重表的持仓全部清仓, 组合优化权重为 0 的股票立即清仓</p>
        </div>

        <div class="section">
            <h2>仓位管理</h2>
            <p>等权模式：每只≈1/15≈6.7% 仓位；优化模式: 单票权重下限 5% 上限 100%，但再约束 weight_sum=1；未设置总仓位上限、涨跌停检查或止损；无现金缓冲。</p>
        </div>

        <div class="section">
            <h2>交易频率</h2>
            <p>月初第 2 个交易日先确定当月金股集合，但不交易；真正交易在每周第 5 个交易日 run_weekly→trade_func，委托类型为 order_target_value/Open 定价。</p>
        </div>

        <div class="section">
            <h2>手动执行指南</h2>
            <p>若手动：
1) 每月初第 2 个交易日前把最新金股列表填入 CSV 并上传。
2) 每周四收盘后跑一次因子脚本，周五（第 5 个交易日）开盘按目标权重下单即可。</p>
        </div>

        <div class="section">
            <h2>代码审计详情</h2>
            <p>主要函数 get_price/ get_price(..., end_date=watch_date) 均以过去数据为端点；next_returns 只用 &lt;watch_date 的历史段计算未来一期收益，不会泄漏真实未来；无使用 history()、attribute_history() 等易出错 API。</p>
        </div>

        <div class="section">
            <h2>灰色区域警告</h2>
            <p>券商金股 CSV 的生成方式未知，若一次性写完可能是未来函数, 聪明钱因子使用 30m 级别数据，聚宽回测分钟线默认 T+0 可用，真实实盘要 T-0 延迟校验, 组合优化 MaxProfit/MaxSharpe 历史窗 120 日可能产生样本内过拟合</p>
        </div>

        <div class="section">
            <h2>执行分析</h2>
            <p>周频+中大盘股对 ≤1000w 资金可行；&gt;1 亿受单票权重和个别小市值金股限制，需分批挂单。</p>
        </div>

        <div class="section">
            <h2>10万资金场景</h2>
            <p>完全可行；滑点可忽略。</p>
        </div>

        <div class="section">
            <h2>100万资金场景</h2>
            <p>可行；低流动性日需拆单。</p>
        </div>

        <div class="section">
            <h2>1000万资金场景</h2>
            <p>部分股票需要分笔成交并放宽成交价；流动性成为显著约束。</p>
        </div>

        <div class="section">
            <h2>1亿资金场景</h2>
            <p>若同一票持仓 5-10% 则单票 5-10千万，非一线白马时冲击成本不可忽视；需引入流动性过滤或分多日建仓。</p>
        </div>

        <div class="section">
            <h2>大资金不友好原因</h2>
            <p>池子通常 15 只，等权时单票≈6.7%；对&gt;1 亿资金容量有限。</p>
        </div>

        <div class="section">
            <h2>行为偏差利用原因</h2>
            <p>AF/Q/RM 因子显式利用波动幅度、聪明钱成交与趋势，捕捉情绪和惯性偏差。</p>
        </div>

        <div class="section">
            <h2>跨阶段稳健性原因</h2>
            <p>依赖券商金股质量 + 近一年动量窗口；不同年份券商荐股偏差及市场风格变化会影响表现。</p>
        </div>

        <div class="section">
            <h2>最差环境</h2>
            <p>券商金股整体失效、主题股狂热但未被券商覆盖, 单边熊市导致动量因子反转</p>
        </div>

        <div class="section">
            <h2>可验证预测</h2>
            <p>金股池中高 AF + 高 Q + 高 RM 的股票未来一周超额收益&gt;0, 组合优化权重与未来周收益正相关, 金股推荐率高但因子分低的股票未来收益低于池平均</p>
        </div>

        <div class="section">
            <h2>一句话总结</h2>
            <p>在卖方“金股”这一先验池上叠加波动-动量择时，逻辑自洽且周频可执行，但需确认金股数据时序合规及实盘流动性。</p>
        </div>

        <div class="section">
            <h2>优化建议</h2>
            <p>1) 引入ST/停牌/市值/成交额过滤；2) 在组合优化中加流动性及单票上限；3) 对因子权重做滚动交叉验证避免过拟合。</p>
        </div>

        <div class="section">
            <h2>假设条件</h2>
            <p>未提供实盘资金规模，默认&lt;1000万元, 默认使用聚宽 order_target_value 市价单；实际撮合滑点假设0.2% 固定</p>
        </div>

        <div class="section">
            <h2>评分汇总</h2>
            <table>
                <tr><th>指标</th><th>分数</th></tr>
                <tr><td>未来函数风险</td><td>3</td></tr>
                <tr><td>滑点</td><td>4</td></tr>
                <tr><td>成本</td><td>4</td></tr>
                <tr><td>执行难度</td><td>6</td></tr>
                <tr><td>时间敏感性</td><td>4</td></tr>
                <tr><td>综合可执行性</td><td>6.5</td></tr>
                <tr><td>大资金不友好</td><td>5</td></tr>
                <tr><td>行为偏差利用</td><td>6</td></tr>
                <tr><td>跨阶段稳健性</td><td>5</td></tr>
                <tr><td>有效性总分</td><td>5.2</td></tr>
                <tr><td>总分</td><td>57.6</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>原始AI响应</h2>
            <pre>```json
{
    &quot;strategy_name&quot;: &quot;券商金股 周频动量增强&quot;,
    &quot;strategy_type&quot;: &quot;多因子选股 + 动量&quot;,
    
    &quot;strategy_explanation&quot;: {
        &quot;core_logic&quot;: &quot;先利用券商每月发布的“金股”列表作为基本池，假设这些股票已被基本面研究筛过；再用振幅、聪明钱(Q)和中长期动量(RM)三类高频/中频价格-量因子对池内股票做横截面打分，每周把综合得分最高的15只股票买入（或保持）；若启用组合优化，则在给定历史窗（默认120 交易日）内求最优权重（MaxProfit/MaxSharpe 等）。思路是：用卖方研究挖掘“好公司”+用市场行为因子择时加仓，力图同时获取基本面 β 与行为 α。&quot;,
        &quot;data_and_indicators&quot;: &quot;1) 手动整理的券商金股 CSV（月度）；2) get_price 日线(close/high/low) 与 30 分钟线(close/vol/open)；3) 因子：AF(20 日振幅分层)、Q(30 分钟聪明钱)、RM(120 日动量)，更新频率=每周一次，回看窗口最长 120 交易日；4) 可选财务数据:无。&quot;,
        &quot;stock_pool&quot;: &quot;对券商月度金股做一次性过滤：排除尾码 HK 的港股；未显式过滤 ST/停牌/次新等，仅在计算因子时用 paused 字段剔除一字跌停。实际下单前未二次校验涨跌停、停牌。&quot;,
        &quot;buy_signals&quot;: [&quot;当周第 5 个交易日开盘，等权因子分数 (AF+Q+RM) 排名前 15 的股票&quot;, &quot;若开启组合优化，则买入优化器给出的正权重股票&quot;],
        &quot;sell_signals&quot;: [&quot;不在最新一周目标列表/权重表的持仓全部清仓&quot;, &quot;组合优化权重为 0 的股票立即清仓&quot;],
        &quot;position_and_risk&quot;: &quot;等权模式：每只≈1/15≈6.7% 仓位；优化模式: 单票权重下限 5% 上限 100%，但再约束 weight_sum=1；未设置总仓位上限、涨跌停检查或止损；无现金缓冲。&quot;,
        &quot;trading_frequency&quot;: &quot;月初第 2 个交易日先确定当月金股集合，但不交易；真正交易在每周第 5 个交易日 run_weekly→trade_func，委托类型为 order_target_value/Open 定价。&quot;,
        &quot;manual_execution_guide&quot;: &quot;若手动：\n1) 每月初第 2 个交易日前把最新金股列表填入 CSV 并上传。\n2) 每周四收盘后跑一次因子脚本，周五（第 5 个交易日）开盘按目标权重下单即可。&quot;
    },
    
    &quot;future_function_detection&quot;: {
        &quot;has_future_function&quot;: &quot;否&quot;,
        &quot;risk_level&quot;: &quot;低&quot;,
        &quot;risk_score&quot;: 3,
        &quot;risk_score_reason&quot;: &quot;主要函数 get_price/ get_price(..., end_date=watch_date) 均以过去数据为端点；next_returns 只用 &lt;watch_date 的历史段计算未来一期收益，不会泄漏真实未来；无使用 history()、attribute_history() 等易出错 API。&quot;,
        &quot;detailed_analysis&quot;: {
            &quot;price_data_leak&quot;: &quot;composition_factors→prepare_data→get_price 使用 end_date&lt;=context.previous_date，未超前。&quot;,
            &quot;financial_data_leak&quot;: &quot;未引用财务数据。&quot;,
            &quot;index_component_leak&quot;: &quot;金股 CSV 如一次性写入全部未来信息则可能泄漏，但文件由用户手动分月维护；代码本身按索引 YYYY-MM 取当月数据，无跨月预知。&quot;,
            &quot;backtest_engine_leak&quot;: &quot;无 history() 之类窗口函数；回测引擎设置 avoid_future_data=True。&quot;
        },
        &quot;fix_suggestions&quot;: &quot;确保回测时按月动态上传/更新金股文件，而不是一次性包含未来月份；若难以保证，改为在线接口按时间增量读取。&quot;,
        &quot;gray_area_warnings&quot;: [&quot;券商金股 CSV 的生成方式未知，若一次性写完可能是未来函数&quot;, &quot;聪明钱因子使用 30m 级别数据，聚宽回测分钟线默认 T+0 可用，真实实盘要 T-0 延迟校验&quot;, &quot;组合优化 MaxProfit/MaxSharpe 历史窗 120 日可能产生样本内过拟合&quot;]
    },
    
    &quot;execution_difficulty&quot;: {
        &quot;slippage_score&quot;: 4,
        &quot;slippage_reason&quot;: &quot;周频、平均 15 只股票，集中在开盘成交；高波动/涨停日易产生 10-30bp 滑点，但远低于日内高频。&quot;,
        &quot;cost_score&quot;: 4,
        &quot;cost_reason&quot;: &quot;周调仓→理论年换手 ~52 次；等权/优化都涉及全仓再平衡，佣金≈0.05%*52≈2.6%/年，属中等成本。&quot;,
        &quot;execution_score&quot;: 6,
        &quot;execution_reason&quot;: &quot;金股多为中大市值，15 只分散；若使用 order_target_value 市价单，1e7 资金以内影响小，但没有涨跌停/流动性保护，极端行情成交困难。&quot;,
        &quot;time_sensitivity_score&quot;: 4,
        &quot;time_sensitivity_reason&quot;: &quot;盘前即可算出信号，开盘一分钟内成交即可；不需盘中高速决策。&quot;,
        &quot;overall_executability&quot;: 6,
        &quot;overall_reason&quot;: &quot;周频+中大盘股对 ≤1000w 资金可行；&gt;1 亿受单票权重和个别小市值金股限制，需分批挂单。&quot;,
        &quot;scenario_analysis&quot;: {
            &quot;10w&quot;: &quot;完全可行；滑点可忽略。&quot;,
            &quot;100w&quot;: &quot;可行；低流动性日需拆单。&quot;,
            &quot;1000w&quot;: &quot;部分股票需要分笔成交并放宽成交价；流动性成为显著约束。&quot;,
            &quot;1y&quot;: &quot;若同一票持仓 5-10% 则单票 5-10千万，非一线白马时冲击成本不可忽视；需引入流动性过滤或分多日建仓。&quot;
        },
        &quot;improvement_suggestions&quot;: [&quot;下单前加入涨跌停和停牌过滤，避免报单失败&quot;, &quot;按流动性设置单票权重上限（如 3 天平均成交额的 5%）&quot;]
    },
    
    &quot;effectiveness&quot;: {
        &quot;large_fund_unfriendly_score&quot;: 5,
        &quot;large_fund_unfriendly_reason&quot;: &quot;池子通常 15 只，等权时单票≈6.7%；对&gt;1 亿资金容量有限。&quot;,
        &quot;behavioral_bias_score&quot;: 6,
        &quot;behavioral_bias_reason&quot;: &quot;AF/Q/RM 因子显式利用波动幅度、聪明钱成交与趋势，捕捉情绪和惯性偏差。&quot;,
        &quot;cross_period_robustness_score&quot;: 5,
        &quot;cross_period_robustness_reason&quot;: &quot;依赖券商金股质量 + 近一年动量窗口；不同年份券商荐股偏差及市场风格变化会影响表现。&quot;,
        &quot;effectiveness_total_score&quot;: 5.5,
        &quot;weight_explanation&quot;: &quot;大资金友好度40% + 行为利用30% + 跨阶段稳健30%&quot;,
        &quot;worst_environments&quot;: [&quot;券商金股整体失效、主题股狂热但未被券商覆盖&quot;, &quot;单边熊市导致动量因子反转&quot;],
        &quot;verifiable_predictions&quot;: [&quot;金股池中高 AF + 高 Q + 高 RM 的股票未来一周超额收益&gt;0&quot;, &quot;组合优化权重与未来周收益正相关&quot;, &quot;金股推荐率高但因子分低的股票未来收益低于池平均&quot;]
    },
    
    &quot;conclusion&quot;: {
        &quot;verdict&quot;: &quot;在卖方“金股”这一先验池上叠加波动-动量择时，逻辑自洽且周频可执行，但需确认金股数据时序合规及实盘流动性。&quot;,
        &quot;recommendation&quot;: &quot;小到中等资金可做小仓实测；若金股数据实时可得且表现可验证，再考虑加大投入。&quot;,
        &quot;optimization_suggestions&quot;: &quot;1) 引入ST/停牌/市值/成交额过滤；2) 在组合优化中加流动性及单票上限；3) 对因子权重做滚动交叉验证避免过拟合。&quot;
    },
    
    &quot;score_summary&quot;: {
        &quot;future_function_risk&quot;: 3,
        &quot;slippage&quot;: 4,
        &quot;cost&quot;: 4,
        &quot;execution&quot;: 6,
        &quot;time_sensitivity&quot;: 4,
        &quot;executability&quot;: 6,
        &quot;effectiveness_a&quot;: 5,
        &quot;effectiveness_b&quot;: 6,
        &quot;effectiveness_c&quot;: 5,
        &quot;effectiveness_total&quot;: 5.5
    },
    
    &quot;assumptions&quot;: [&quot;未提供实盘资金规模，默认&lt;1000万元&quot;, &quot;默认使用聚宽 order_target_value 市价单；实际撮合滑点假设0.2% 固定&quot;]
}
```</pre>
        </div>

    </div>
</body>
</html>