<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSRS择时 + SVR中小板价值残差选股 - 策略详情</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 30px;
            line-height: 1.8;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .meta { color: #888; margin-bottom: 30px; font-size: 0.9rem; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h2 {
            font-size: 1.2rem;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section p, .section pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #ccc;
        }
        pre {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .back-btn:hover { opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(0,0,0,0.2); color: #00d4ff; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">← 返回列表</a>
        <h1>RSRS择时 + SVR中小板价值残差选股</h1>
        <p class="meta">
            ID: e9458977 | 
            类型: 多因子选股+趋势择时 | 
            来源: b25_41SVR机器学习上证综指择时中小板财务选股策略.txt |
            分析日期: 2026-01-10 22:25:40
        </p>

        <div class="section">
            <h2>策略逻辑概要</h2>
            <p>用18×600 RSRS 指数择时，只有在大盘（以上证综指为代理）呈现上升或动能改善时才持仓；个股端在中小板股票中用支持向量回归（SVR）模型判断“估值残差”，挑选被低估且基本面改善的股票买入持有 10 只，期望获取超额收益并用大盘空仓控制系统性风险。</p>
        </div>

        <div class="section">
            <h2>股票池</h2>
            <p>初始以中小板综指(399101.XSHE)成分股为母池 → 基本面过滤：剔除负净利润、资产负债率&gt;100%、PB≤0、经营性现金流/经营利润≤5% 等；未显式过滤 ST/停牌/涨跌停/科创/创业/次新，相关函数已写但未在 today_prepare 中调用。</p>
        </div>

        <div class="section">
            <h2>买入信号</h2>
            <p>大盘择时信号为 BUY（满足 RSRS 及指数动量条件）且当前仓位状态为空仓, 个股处于 SVR 残差排序最小前 n_choice(=1.2×10) 并仍通过财务过滤</p>
        </div>

        <div class="section">
            <h2>卖出信号</h2>
            <p>大盘择时信号为 SELL（RSRS 动量下行等条件）, 个股不再位于当日 SVR 择股名单时会被调出（在 adjust_position 中执行）</p>
        </div>

        <div class="section">
            <h2>仓位管理</h2>
            <p>目标持仓 10 只等权；open_position(order_target_value) 自动把现金均分到缺口；空仓时 g.curstaut=0，持仓后 g.curstaut=1；无单仓或整体止损/止盈；无涨跌停检查，可能因跌停卖不出或涨停买不到。</p>
        </div>

        <div class="section">
            <h2>交易频率</h2>
            <p>run_daily：09:00 生成名单，09:30 用 order_target_value 调仓；逻辑上可做到日频调仓，若择时保持 BUY 则仅对名单变动的个股买卖。</p>
        </div>

        <div class="section">
            <h2>手动执行指南</h2>
            <p>盘前(≈09:00)先跑 today_prepare 得到买卖列表 → 09:30 挂市价或限价单等权买入/卖出；若择时呈 SELL 全部清仓；每个交易日重复。</p>
        </div>

        <div class="section">
            <h2>代码审计详情</h2>
            <p>所有 get_fundamentals 使用 dt_last=context.previous_date；attribute_history 在 09:00 调用时仅含上一交易日收盘数据；代码显式 set_option(&#x27;avoid_future_data&#x27;, True)。未发现 look_ahead。</p>
        </div>

        <div class="section">
            <h2>灰色区域警告</h2>
            <p>09:30 下单使用市价模拟，实盘需考虑涨跌停导致无法成交, 未对财报披露滞后进行处理，极端情况下仍可能使用未来信息, RSRS 参数 M=600, N=18 较长，历史数据滚动插值在新上市指数成分上可能有缺口</p>
        </div>

        <div class="section">
            <h2>执行分析</h2>
            <p>小中资金可执行，需注意封涨跌停、停牌导致的偏离；大资金会遇到流动性瓶颈。</p>
        </div>

        <div class="section">
            <h2>10万资金场景</h2>
            <p>基本可无冲击成交；换手费率影响可控</p>
        </div>

        <div class="section">
            <h2>100万资金场景</h2>
            <p>大部分标的流动性可接受，若遇涨停需顺延</p>
        </div>

        <div class="section">
            <h2>1000万资金场景</h2>
            <p>部分标的日均成交额低于需买入金额，需分多日建仓，滑点明显上升</p>
        </div>

        <div class="section">
            <h2>1亿资金场景</h2>
            <p>无法在原策略框架执行，板块容量限制严重</p>
        </div>

        <div class="section">
            <h2>大资金不友好原因</h2>
            <p>中小板等权 10 只，目标股票普遍中小市值；容量中等，资金&gt;3000 万成交冲击明显。</p>
        </div>

        <div class="section">
            <h2>行为偏差利用原因</h2>
            <p>策略利用动量恐慌/估值修复等行为偏差，但核心仍是基本面 + 估值残差。</p>
        </div>

        <div class="section">
            <h2>跨阶段稳健性原因</h2>
            <p>依赖特定 RSRS 参数与中小板行情；不同年份大小盘轮动可能导致失效。</p>
        </div>

        <div class="section">
            <h2>最差环境</h2>
            <p>中小盘整体失宠、流动性枯竭的熊市, 快速跌停潮导致择时 SELL 信号迟滞、无法及时止损</p>
        </div>

        <div class="section">
            <h2>可验证预测</h2>
            <p>BUY 信号后指数未来 10~20 交易日上涨概率显著高于基准, SVR 负残差股票在后 1 个月相对指数有正向超额收益, SELL 信号下空仓期组合回撤显著小于持仓期</p>
        </div>

        <div class="section">
            <h2>一句话总结</h2>
            <p>整体为低频 RSRS 择时 + SVR 价值残差选股，逻辑清晰但换手略高、容量有限，未来函数风险低。</p>
        </div>

        <div class="section">
            <h2>优化建议</h2>
            <p>并入停牌/ST/涨跌停过滤；将调仓频率调至周或月；增加成交量/换手率过滤提高流动性；加入单只仓位控制和止损机制</p>
        </div>

        <div class="section">
            <h2>假设条件</h2>
            <p>未提供初始资金规模，默认聚宽回测 1,000,000 元人民币, 使用聚宽默认撮合（按开盘价/实时价成交），未设置额外滑点，实际交易需考虑滑点及涨跌停无法成交</p>
        </div>

        <div class="section">
            <h2>评分汇总</h2>
            <table>
                <tr><th>指标</th><th>分数</th></tr>
                <tr><td>未来函数风险</td><td>2</td></tr>
                <tr><td>滑点</td><td>4</td></tr>
                <tr><td>成本</td><td>5</td></tr>
                <tr><td>执行难度</td><td>5</td></tr>
                <tr><td>时间敏感性</td><td>4</td></tr>
                <tr><td>综合可执行性</td><td>6.5</td></tr>
                <tr><td>大资金不友好</td><td>6</td></tr>
                <tr><td>行为偏差利用</td><td>5</td></tr>
                <tr><td>跨阶段稳健性</td><td>4</td></tr>
                <tr><td>有效性总分</td><td>4.9</td></tr>
                <tr><td>总分</td><td>56.3</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>原始AI响应</h2>
            <pre>```json
{
    &quot;strategy_name&quot;: &quot;RSRS择时 + SVR中小板价值残差选股&quot;,
    &quot;strategy_type&quot;: &quot;多因子选股+趋势择时&quot;,
    
    &quot;strategy_explanation&quot;: {
        &quot;core_logic&quot;: &quot;用18×600 RSRS 指数择时，只有在大盘（以上证综指为代理）呈现上升或动能改善时才持仓；个股端在中小板股票中用支持向量回归（SVR）模型判断“估值残差”，挑选被低估且基本面改善的股票买入持有 10 只，期望获取超额收益并用大盘空仓控制系统性风险。&quot;,
        &quot;data_and_indicators&quot;: &quot;价格数据：上证综指过去 600+18+8 日的日线 high/low/close（计算 RSRS、斜率）\n财务数据：valuation、income、balance、indicator、cash_flow（上一财报期，可得频率为季）\n行业归属：申万一级行业静态名单\n指标：RSRS z-score、RSRS slope、指数 8 日收盘价斜率、SVR 残差（log_mc − 预测值）等&quot;,
        &quot;stock_pool&quot;: &quot;初始以中小板综指(399101.XSHE)成分股为母池 → 基本面过滤：剔除负净利润、资产负债率&gt;100%、PB≤0、经营性现金流/经营利润≤5% 等；未显式过滤 ST/停牌/涨跌停/科创/创业/次新，相关函数已写但未在 today_prepare 中调用。&quot;,
        &quot;buy_signals&quot;: [
            &quot;大盘择时信号为 BUY（满足 RSRS 及指数动量条件）且当前仓位状态为空仓&quot;,
            &quot;个股处于 SVR 残差排序最小前 n_choice(=1.2×10) 并仍通过财务过滤&quot;
        ],
        &quot;sell_signals&quot;: [
            &quot;大盘择时信号为 SELL（RSRS 动量下行等条件）&quot;,
            &quot;个股不再位于当日 SVR 择股名单时会被调出（在 adjust_position 中执行）&quot;
        ],
        &quot;position_and_risk&quot;: &quot;目标持仓 10 只等权；open_position(order_target_value) 自动把现金均分到缺口；空仓时 g.curstaut=0，持仓后 g.curstaut=1；无单仓或整体止损/止盈；无涨跌停检查，可能因跌停卖不出或涨停买不到。&quot;,
        &quot;trading_frequency&quot;: &quot;run_daily：09:00 生成名单，09:30 用 order_target_value 调仓；逻辑上可做到日频调仓，若择时保持 BUY 则仅对名单变动的个股买卖。&quot;,
        &quot;manual_execution_guide&quot;: &quot;盘前(≈09:00)先跑 today_prepare 得到买卖列表 → 09:30 挂市价或限价单等权买入/卖出；若择时呈 SELL 全部清仓；每个交易日重复。&quot;
    },
    
    &quot;future_function_detection&quot;: {
        &quot;has_future_function&quot;: &quot;否&quot;,
        &quot;risk_level&quot;: &quot;低&quot;,
        &quot;risk_score&quot;: 2,
        &quot;risk_score_reason&quot;: &quot;所有 get_fundamentals 使用 dt_last=context.previous_date；attribute_history 在 09:00 调用时仅含上一交易日收盘数据；代码显式 set_option(&#x27;avoid_future_data&#x27;, True)。未发现 look_ahead。&quot;,
        &quot;detailed_analysis&quot;: {
            &quot;price_data_leak&quot;: &quot;attribute_history(&#x27;1d&#x27;) 在未开盘时间点仅返回 T-1 数据 → 无泄漏&quot;,
            &quot;financial_data_leak&quot;: &quot;get_fundamentals 统一用 previous_date → 与财报发布时间序列一致；虽未对财报发布日期做进一步过滤，但 joinquant 默认可用性与真实披露日一致，风险可接受&quot;,
            &quot;index_component_leak&quot;: &quot;get_index_stocks(index, dt_last) 使用上一交易日日期 → 无未来成分泄漏&quot;,
            &quot;backtest_engine_leak&quot;: &quot;无自定义持久化或直接读取未来文件 → 风险极低&quot;
        },
        &quot;fix_suggestions&quot;: &quot;1) 显式对财报发布时间进行过滤（例如 add info_date 条件）\n2) today_prepare 中应调用 ST/停牌/新股/科创过滤函数，防止实盘异常&quot;,
        &quot;gray_area_warnings&quot;: [
            &quot;09:30 下单使用市价模拟，实盘需考虑涨跌停导致无法成交&quot;,
            &quot;未对财报披露滞后进行处理，极端情况下仍可能使用未来信息&quot;,
            &quot;RSRS 参数 M=600, N=18 较长，历史数据滚动插值在新上市指数成分上可能有缺口&quot;
        ]
    },
    
    &quot;execution_difficulty&quot;: {
        &quot;slippage_score&quot;: 4,
        &quot;slippage_reason&quot;: &quot;10 只中小板股，日内 09:30 直接等权建仓/调仓；虽不是高频，但中小板流动性相对主板差，正向滑点中等。&quot;,
        &quot;cost_score&quot;: 5,
        &quot;cost_reason&quot;: &quot;理想状态下日频检查并可能卖出/买入，换手中等偏上；佣金万一+千一印花税已设置。&quot;,
        &quot;execution_score&quot;: 5,
        &quot;execution_reason&quot;: &quot;对价单且无拆单逻辑，容量有限；大单或涨跌停时成交概率下降。&quot;,
        &quot;time_sensitivity_score&quot;: 4,
        &quot;time_sensitivity_reason&quot;: &quot;信号于开盘前确定，09:30 下单即可；不需秒级，但需当日完成。&quot;,
        &quot;overall_executability&quot;: 6,
        &quot;overall_reason&quot;: &quot;小中资金可执行，需注意封涨跌停、停牌导致的偏离；大资金会遇到流动性瓶颈。&quot;,
        &quot;scenario_analysis&quot;: {
            &quot;10w&quot;: &quot;基本可无冲击成交；换手费率影响可控&quot;,
            &quot;100w&quot;: &quot;大部分标的流动性可接受，若遇涨停需顺延&quot;,
            &quot;1000w&quot;: &quot;部分标的日均成交额低于需买入金额，需分多日建仓，滑点明显上升&quot;,
            &quot;1y&quot;: &quot;无法在原策略框架执行，板块容量限制严重&quot;
        },
        &quot;improvement_suggestions&quot;: [
            &quot;增加涨跌停/成交量过滤与动态挂单策略&quot;,
            &quot;改为周频或月频调仓，以降低成本并提升容量&quot;
        ]
    },
    
    &quot;effectiveness&quot;: {
        &quot;large_fund_unfriendly_score&quot;: 6,
        &quot;large_fund_unfriendly_reason&quot;: &quot;中小板等权 10 只，目标股票普遍中小市值；容量中等，资金&gt;3000 万成交冲击明显。&quot;,
        &quot;behavioral_bias_score&quot;: 5,
        &quot;behavioral_bias_reason&quot;: &quot;策略利用动量恐慌/估值修复等行为偏差，但核心仍是基本面 + 估值残差。&quot;,
        &quot;cross_period_robustness_score&quot;: 4,
        &quot;cross_period_robustness_reason&quot;: &quot;依赖特定 RSRS 参数与中小板行情；不同年份大小盘轮动可能导致失效。&quot;,
        &quot;effectiveness_total_score&quot;: 5.0,
        &quot;weight_explanation&quot;: &quot;大资金不友好40%+行为偏差30%+跨阶段稳健30%&quot;,
        &quot;worst_environments&quot;: [
            &quot;中小盘整体失宠、流动性枯竭的熊市&quot;,
            &quot;快速跌停潮导致择时 SELL 信号迟滞、无法及时止损&quot;
        ],
        &quot;verifiable_predictions&quot;: [
            &quot;BUY 信号后指数未来 10~20 交易日上涨概率显著高于基准&quot;,
            &quot;SVR 负残差股票在后 1 个月相对指数有正向超额收益&quot;,
            &quot;SELL 信号下空仓期组合回撤显著小于持仓期&quot;
        ]
    },
    
    &quot;conclusion&quot;: {
        &quot;verdict&quot;: &quot;整体为低频 RSRS 择时 + SVR 价值残差选股，逻辑清晰但换手略高、容量有限，未来函数风险低。&quot;,
        &quot;recommendation&quot;: &quot;小仓实测&quot;,
        &quot;optimization_suggestions&quot;: &quot;并入停牌/ST/涨跌停过滤；将调仓频率调至周或月；增加成交量/换手率过滤提高流动性；加入单只仓位控制和止损机制&quot;
    },
    
    &quot;score_summary&quot;: {
        &quot;future_function_risk&quot;: 2,
        &quot;slippage&quot;: 4,
        &quot;cost&quot;: 5,
        &quot;execution&quot;: 5,
        &quot;time_sensitivity&quot;: 4,
        &quot;executability&quot;: 6,
        &quot;effectiveness_a&quot;: 6,
        &quot;effectiveness_b&quot;: 5,
        &quot;effectiveness_c&quot;: 4,
        &quot;effectiveness_total&quot;: 5.0
    },
    
    &quot;assumptions&quot;: [
        &quot;未提供初始资金规模，默认聚宽回测 1,000,000 元人民币&quot;,
        &quot;使用聚宽默认撮合（按开盘价/实时价成交），未设置额外滑点，实际交易需考虑滑点及涨跌停无法成交&quot;
    ]
}
```</pre>
        </div>

    </div>
</body>
</html>