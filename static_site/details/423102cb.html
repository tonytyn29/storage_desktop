<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PMI-周期+均线双模定投策略 - 策略详情</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Microsoft YaHei', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
            padding: 30px;
            line-height: 1.8;
        }
        .container { max-width: 1000px; margin: 0 auto; }
        h1 {
            font-size: 2rem;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }
        .meta { color: #888; margin-bottom: 30px; font-size: 0.9rem; }
        .section {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .section h2 {
            font-size: 1.2rem;
            color: #00d4ff;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .section p, .section pre {
            white-space: pre-wrap;
            word-wrap: break-word;
            color: #ccc;
        }
        pre {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.85rem;
        }
        .back-btn {
            display: inline-block;
            padding: 10px 20px;
            background: linear-gradient(90deg, #00d4ff, #7b2ff7);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .back-btn:hover { opacity: 0.9; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1); }
        th { background: rgba(0,0,0,0.2); color: #00d4ff; }
    </style>
</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-btn">← 返回列表</a>
        <h1>PMI-周期+均线双模定投策略</h1>
        <p class="meta">
            ID: 423102cb | 
            类型: 趋势跟踪 / 宏观择时 | 
            来源: b2324_48.一种宏观数据的中长线策略，年化15%，最大回撤9%.txt |
            分析日期: 2026-01-11 18:19:01
        </p>

        <div class="section">
            <h2>策略逻辑概要</h2>
            <p>先用制造业 PMI 的分项数据识别宏观经济处于复苏→过热→滞涨→衰退的阶段；在复苏阶段启动长期 (mode=1) 1248 定投买入沪深300ETF，经济过热或技术面信号出现后再通过均线、年线触发中线 (mode=2) 加减仓；衰退或技术拐点再切回债券 ETF，力求在股债轮动中捕捉中长周期 Beta 收益并降低回撤。</p>
        </div>

        <div class="section">
            <h2>股票池</h2>
            <p>实际只交易两只 ETF：510300.XSHG (沪深300) 与 511010.XSHG (国债/货币类)。无 ST、停牌过滤需求。</p>
        </div>

        <div class="section">
            <h2>买入信号</h2>
            <p>① mode=1/2 内按照 1248 规则定额加仓 (价格相对记录价下跌或每周第一交易日), ② 技术右侧: ma5&gt;ma10&gt;ma20&gt;ma30 且 ma30 上行时，用全部可用现金买入 510300</p>
        </div>

        <div class="section">
            <h2>卖出信号</h2>
            <p>① 经济过热且库存进入滞涨 → mode 从 1 切 2，再等待技术面, ② mode=2 中出现 当前价&gt;ma120 且 ma5 从上向下穿 ma20 时全部卖出 510300，转买 511010</p>
        </div>

        <div class="section">
            <h2>仓位管理</h2>
            <p>单品 ETF，无分散。加仓按 2^times*4%*总资产 递增 (即 1248…)；未设置总仓上限，理论最高 100% 股仓，债仓亦可 100%。没有显式止损，仅靠技术面和经济阶段切换。</p>
        </div>

        <div class="section">
            <h2>交易频率</h2>
            <p>检查逻辑 run_daily 14:55；正常情况下每周一次定投，如遇加仓/卖出信号则可能周内多次。</p>
        </div>

        <div class="section">
            <h2>手动执行指南</h2>
            <p>盘中 14:50-15:00 观察是否触发 signal，通过市价单或收盘价下单；如无法盘中操作，可收盘后下一交易日开盘完成，因信号日频变化不大。宏观判断月度更新，无须日常干预。</p>
        </div>

        <div class="section">
            <h2>代码审计详情</h2>
            <p>run_query 直接按 stat_month&lt;=当月 调用 PMI 数据；回测时月内尚未发布的 PMI 就已可见，存在潜在前视。(函数: get_PMI, calc_provide_and_need, calc_save)</p>
        </div>

        <div class="section">
            <h2>灰色区域警告</h2>
            <p>宏观数据库发布日期不透明，需确认真实可得性, 日内 14:55 使用 include_now=True 取未收盘的均线，实盘均线和回测有微差, 1248 翻倍加仓无总仓上限，极端下跌中有失控风险</p>
        </div>

        <div class="section">
            <h2>执行分析</h2>
            <p>流动性充裕 + 低频，机构级别亦可执行；唯极端翻倍加仓需要大额备用资金。</p>
        </div>

        <div class="section">
            <h2>10万资金场景</h2>
            <p>极易执行，买 100 手级别。</p>
        </div>

        <div class="section">
            <h2>100万资金场景</h2>
            <p>仍仅占全天成交 &lt;0.2%，影响可忽略。</p>
        </div>

        <div class="section">
            <h2>1000万资金场景</h2>
            <p>需分批但仍可一次成交在盘口完成。</p>
        </div>

        <div class="section">
            <h2>1亿资金场景</h2>
            <p>占流动性 1-2%，需要窗口指令拆单，仍可落地。</p>
        </div>

        <div class="section">
            <h2>大资金不友好原因</h2>
            <p>ETF 容量大，对资金规模友好</p>
        </div>

        <div class="section">
            <h2>行为偏差利用原因</h2>
            <p>主要依赖经济周期与趋势指标，非情绪/行为逻辑</p>
        </div>

        <div class="section">
            <h2>跨阶段稳健性原因</h2>
            <p>2005-2023 PMI/股债轮动大体有效，但对宏观规律与估值变化敏感</p>
        </div>

        <div class="section">
            <h2>最差环境</h2>
            <p>长时间震荡无趋势且 PMI 反复钝化, 极端流动性危机导致股债同跌</p>
        </div>

        <div class="section">
            <h2>可验证预测</h2>
            <p>经济复苏阶段股市年回报&gt;债券, PMI 生产&lt;50 且新订单&gt;50 时买入未来 12 个月优于基准, ma5 下穿 ma20 且价&gt;ma120 后未来 3 个月股市收益低于债券</p>
        </div>

        <div class="section">
            <h2>一句话总结</h2>
            <p>逻辑清晰、交易可落地，但回测可能透视 PMI，需修正后再评估。</p>
        </div>

        <div class="section">
            <h2>优化建议</h2>
            <p>引入公布日校准的宏观数据；对 1248 加仓设置资金上限/资金利用率阈值；考虑纳入估值或波动率条件以提升风险收益。</p>
        </div>

        <div class="section">
            <h2>假设条件</h2>
            <p>未给出初始资金、滑点模型、买卖委托类型，默认 JoinQuant 回测缺省 (撮合价=当根 bar 收盘价), 宏观数据库中的 PMI 等数据在 stat_month 后一月初才可获；若实际更晚，请自行调整查询窗口</p>
        </div>

        <div class="section">
            <h2>评分汇总</h2>
            <table>
                <tr><th>指标</th><th>分数</th></tr>
                <tr><td>未来函数风险</td><td>6</td></tr>
                <tr><td>滑点</td><td>2</td></tr>
                <tr><td>成本</td><td>3</td></tr>
                <tr><td>执行难度</td><td>9</td></tr>
                <tr><td>时间敏感性</td><td>3</td></tr>
                <tr><td>综合可执行性</td><td>6.8</td></tr>
                <tr><td>大资金不友好</td><td>2</td></tr>
                <tr><td>行为偏差利用</td><td>3</td></tr>
                <tr><td>跨阶段稳健性</td><td>5</td></tr>
                <tr><td>有效性总分</td><td>3.5</td></tr>
                <tr><td>总分</td><td>50.1</td></tr>
            </table>
        </div>

        <div class="section">
            <h2>原始AI响应</h2>
            <pre>```json
{
    &quot;strategy_name&quot;: &quot;PMI-周期+均线双模定投策略&quot;,
    &quot;strategy_type&quot;: &quot;趋势跟踪 / 宏观择时&quot;,

    &quot;strategy_explanation&quot;: {
        &quot;core_logic&quot;: &quot;先用制造业 PMI 的分项数据识别宏观经济处于复苏→过热→滞涨→衰退的阶段；在复苏阶段启动长期 (mode=1) 1248 定投买入沪深300ETF，经济过热或技术面信号出现后再通过均线、年线触发中线 (mode=2) 加减仓；衰退或技术拐点再切回债券 ETF，力求在股债轮动中捕捉中长周期 Beta 收益并降低回撤。&quot;,
        &quot;data_and_indicators&quot;: &quot;1) macro.MAC_MANUFACTURING_PMI 中 pmi、produce_idx、new_orders_idx、raw_material_idx、finished_produce_idx（月频）\n2) 000300 指数与 510300 价格（日、月、年 K 线）\n3) 均线: 日 MA5/10/20/30/120, 年 MA10（基于月线聚合）\n所有价格数据使用 get_bars, 宏观数据使用 run_query。&quot;,
        &quot;stock_pool&quot;: &quot;实际只交易两只 ETF：510300.XSHG (沪深300) 与 511010.XSHG (国债/货币类)。无 ST、停牌过滤需求。&quot;,
        &quot;buy_signals&quot;: [&quot;① mode=1/2 内按照 1248 规则定额加仓 (价格相对记录价下跌或每周第一交易日)&quot;, &quot;② 技术右侧: ma5&gt;ma10&gt;ma20&gt;ma30 且 ma30 上行时，用全部可用现金买入 510300&quot;],
        &quot;sell_signals&quot;: [&quot;① 经济过热且库存进入滞涨 → mode 从 1 切 2，再等待技术面&quot;, &quot;② mode=2 中出现 当前价&gt;ma120 且 ma5 从上向下穿 ma20 时全部卖出 510300，转买 511010&quot;],
        &quot;position_and_risk&quot;: &quot;单品 ETF，无分散。加仓按 2^times*4%*总资产 递增 (即 1248…)；未设置总仓上限，理论最高 100% 股仓，债仓亦可 100%。没有显式止损，仅靠技术面和经济阶段切换。&quot;,
        &quot;trading_frequency&quot;: &quot;检查逻辑 run_daily 14:55；正常情况下每周一次定投，如遇加仓/卖出信号则可能周内多次。&quot;,
        &quot;manual_execution_guide&quot;: &quot;盘中 14:50-15:00 观察是否触发 signal，通过市价单或收盘价下单；如无法盘中操作，可收盘后下一交易日开盘完成，因信号日频变化不大。宏观判断月度更新，无须日常干预。&quot;
    },

    &quot;future_function_detection&quot;: {
        &quot;has_future_function&quot;: &quot;不确定&quot;,
        &quot;risk_level&quot;: &quot;中&quot;,
        &quot;risk_score&quot;: 6,
        &quot;risk_score_reason&quot;: &quot;run_query 直接按 stat_month&lt;=当月 调用 PMI 数据；回测时月内尚未发布的 PMI 就已可见，存在潜在前视。(函数: get_PMI, calc_provide_and_need, calc_save)&quot;,
        &quot;detailed_analysis&quot;: {
            &quot;price_data_leak&quot;: &quot;未发现使用未来价格；get_bars(include_now=True) 取到当日尚未收盘价但 14:55 已基本成交，影响有限。&quot;,
            &quot;financial_data_leak&quot;: &quot;未使用财务数据。&quot;,
            &quot;index_component_leak&quot;: &quot;仅交易 ETF，无指数成分调用。&quot;,
            &quot;backtest_engine_leak&quot;: &quot;宏观数据在回测数据库中预先填充，构成隐式未来函数。&quot;
        },
        &quot;fix_suggestions&quot;: &quot;把 PMI 等宏观数据的可获日期映射为实际公布日 (一般次月首日) 并在回测中过滤当前月数据；或简单地将查询日期改为上一月。&quot;,
        &quot;gray_area_warnings&quot;: [&quot;宏观数据库发布日期不透明，需确认真实可得性&quot;, &quot;日内 14:55 使用 include_now=True 取未收盘的均线，实盘均线和回测有微差&quot;, &quot;1248 翻倍加仓无总仓上限，极端下跌中有失控风险&quot;]
    },

    &quot;execution_difficulty&quot;: {
        &quot;slippage_score&quot;: 2,
        &quot;slippage_reason&quot;: &quot;510300、511010 日均成交数十亿以上，单笔百万元以内冲击极低。&quot;,
        &quot;cost_score&quot;: 3,
        &quot;cost_reason&quot;: &quot;周级定投+偶发加仓，换手低；佣金万3、卖出印花税千1，债券 ETF 无印花。&quot;,
        &quot;execution_score&quot;: 9,
        &quot;execution_reason&quot;: &quot;仅两只超高流动性 ETF，无需拆单，市价即可成交。&quot;,
        &quot;time_sensitivity_score&quot;: 3,
        &quot;time_sensitivity_reason&quot;: &quot;信号日频，收盘或次日执行对收益影响很小。&quot;,
        &quot;overall_executability&quot;: 8,
        &quot;overall_reason&quot;: &quot;流动性充裕 + 低频，机构级别亦可执行；唯极端翻倍加仓需要大额备用资金。&quot;,
        &quot;scenario_analysis&quot;: {
            &quot;10w&quot;: &quot;极易执行，买 100 手级别。&quot;,
            &quot;100w&quot;: &quot;仍仅占全天成交 &lt;0.2%，影响可忽略。&quot;,
            &quot;1000w&quot;: &quot;需分批但仍可一次成交在盘口完成。&quot;,
            &quot;1y&quot;: &quot;占流动性 1-2%，需要窗口指令拆单，仍可落地。&quot;
        },
        &quot;improvement_suggestions&quot;: [&quot;给 1248 加仓设定最大股仓占比或 VaR 约束&quot;, &quot;日内改用收盘价执行，减少 intraday 均线歧义&quot;]
    },

    &quot;effectiveness&quot;: {
        &quot;large_fund_unfriendly_score&quot;: 2,
        &quot;large_fund_unfriendly_reason&quot;: &quot;ETF 容量大，对资金规模友好&quot;,
        &quot;behavioral_bias_score&quot;: 3,
        &quot;behavioral_bias_reason&quot;: &quot;主要依赖经济周期与趋势指标，非情绪/行为逻辑&quot;,
        &quot;cross_period_robustness_score&quot;: 5,
        &quot;cross_period_robustness_reason&quot;: &quot;2005-2023 PMI/股债轮动大体有效，但对宏观规律与估值变化敏感&quot;,
        &quot;effectiveness_total_score&quot;: 4.0,
        &quot;weight_explanation&quot;: &quot;大资金友好40%+行为偏差30%+跨阶段稳健30%&quot;,
        &quot;worst_environments&quot;: [&quot;长时间震荡无趋势且 PMI 反复钝化&quot;, &quot;极端流动性危机导致股债同跌&quot;],
        &quot;verifiable_predictions&quot;: [&quot;经济复苏阶段股市年回报&gt;债券&quot;, &quot;PMI 生产&lt;50 且新订单&gt;50 时买入未来 12 个月优于基准&quot;, &quot;ma5 下穿 ma20 且价&gt;ma120 后未来 3 个月股市收益低于债券&quot;]
    },

    &quot;conclusion&quot;: {
        &quot;verdict&quot;: &quot;逻辑清晰、交易可落地，但回测可能透视 PMI，需修正后再评估。&quot;,
        &quot;recommendation&quot;: &quot;小仓实测&quot;,
        &quot;optimization_suggestions&quot;: &quot;引入公布日校准的宏观数据；对 1248 加仓设置资金上限/资金利用率阈值；考虑纳入估值或波动率条件以提升风险收益。&quot;
    },

    &quot;score_summary&quot;: {
        &quot;future_function_risk&quot;: 6,
        &quot;slippage&quot;: 2,
        &quot;cost&quot;: 3,
        &quot;execution&quot;: 9,
        &quot;time_sensitivity&quot;: 3,
        &quot;executability&quot;: 8,
        &quot;effectiveness_a&quot;: 2,
        &quot;effectiveness_b&quot;: 3,
        &quot;effectiveness_c&quot;: 5,
        &quot;effectiveness_total&quot;: 4.0
    },

    &quot;assumptions&quot;: [
        &quot;未给出初始资金、滑点模型、买卖委托类型，默认 JoinQuant 回测缺省 (撮合价=当根 bar 收盘价)&quot;,
        &quot;宏观数据库中的 PMI 等数据在 stat_month 后一月初才可获；若实际更晚，请自行调整查询窗口&quot;
    ]
}
```</pre>
        </div>

    </div>
</body>
</html>